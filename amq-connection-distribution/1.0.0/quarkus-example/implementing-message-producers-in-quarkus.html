<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Implementing message producers in Quarkus :: Building Resilient Messaging Applications with ActiveMQ Artemis and OpenShift</title>
    <link rel="prev" href="configuring-quarkus-for-activemq-artemis-connectivity.html">
    <link rel="next" href="implementing-message-consumers-in-quarkus.html">
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://www.redhat.com" target="_blank"><img src="../../../_/img/redhat-logo.png" height="40px" alt="Red Hat"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="../../..">Building Resilient Messaging Applications with ActiveMQ Artemis and OpenShift</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://github.com/RedHatQuickCourses/REPLACEREPONAME/issues" target="_blank">Report Issues</a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="amq-connection-distribution" data-version="1.0.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Building Resilient Messaging Applications with ActiveMQ Artemis and OpenShift</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Home</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../deploying-activemq-artemis-on-openshift/deploying-activemq-artemis-on-openshift.html">Deploying ActiveMQ Artemis on OpenShift</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../deploying-activemq-artemis-on-openshift/introduction-to-openshift-for-messaging-applications.html">Introduction to OpenShift for messaging applications</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../deploying-activemq-artemis-on-openshift/understanding-activemq-artemis-on-openshift.html">Understanding ActiveMQ Artemis on OpenShift</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../deploying-activemq-artemis-on-openshift/using-the-activemq-artemis-operator.html">Using the ActiveMQ Artemis Operator</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../deploying-activemq-artemis-on-openshift/custom-resource-definitions-crds-for-artemis.html">Custom Resource Definitions (CRDs) for Artemis</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../deploying-activemq-artemis-on-openshift/configuring-persistent-storage-for-artemis.html">Configuring persistent storage for Artemis</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../deploying-activemq-artemis-on-openshift/scaling-artemis-brokers-on-openshift.html">Scaling Artemis brokers on OpenShift</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../deploying-activemq-artemis-on-openshift/monitoring-artemis-instances-on-openshift.html">Monitoring Artemis instances on OpenShift</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../deploying-activemq-artemis-on-openshift/hands-on-lab-deploying-a-highly-available-activemq-artemis-cluster-on-openshift.html">Hands-on Lab: Deploying a highly available ActiveMQ Artemis cluster on OpenShift</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../message-distribution-issues/message-distribution-issues.html">Message distribution issues</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../message-distribution-issues/understanding-distributed-messaging-patterns.html">Understanding distributed messaging patterns</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../message-distribution-issues/load-balancing-messages-across-consumers.html">Load balancing messages across consumers</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../message-distribution-issues/message-routing-strategies-and-challenges.html">Message routing strategies and challenges</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../message-distribution-issues/consumer-groups-and-shared-subscriptions.html">Consumer groups and shared subscriptions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../message-distribution-issues/ensuring-message-ordering-in-distributed-systems.html">Ensuring message ordering in distributed systems</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../message-distribution-issues/handling-message-durability-and-reliability.html">Handling message durability and reliability</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../message-distribution-issues/addressing-fault-tolerance-and-high-availability-for-messages.html">Addressing fault tolerance and high availability for messages</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../client-side-solution/client-side-solution.html">Client Side Solution</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../client-side-solution/client-side-connection-management-and-pooling.html">Client-side connection management and pooling</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../client-side-solution/implementing-client-failover-mechanisms.html">Implementing client failover mechanisms</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../client-side-solution/client-side-load-balancing-for-message-consumption.html">Client-side load balancing for message consumption</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../client-side-solution/message-acknowledgment-patterns-auto_acknowledge-client_acknowledge.html">Message acknowledgment patterns (AUTO_ACKNOWLEDGE, CLIENT_ACKNOWLEDGE)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../client-side-solution/transaction-management-for-message-producers-and-consumers.html">Transaction management for message producers and consumers</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../client-side-solution/best-practices-for-client-integration-with-distributed-brokers.html">Best practices for client integration with distributed brokers</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="quarkus-example.html">Quarkus Example</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="integrating-jmsamqp-clients-with-quarkus.html">Integrating JMS/AMQP clients with Quarkus</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="configuring-quarkus-for-activemq-artemis-connectivity.html">Configuring Quarkus for ActiveMQ Artemis connectivity</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="implementing-message-producers-in-quarkus.html">Implementing message producers in Quarkus</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="implementing-message-consumers-in-quarkus.html">Implementing message consumers in Quarkus</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="reactive-messaging-with-quarkus-and-artemis.html">Reactive messaging with Quarkus and Artemis</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="deploying-quarkus-messaging-applications-on-openshift.html">Deploying Quarkus messaging applications on OpenShift</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="hands-on-lab-developing-a-quarkus-microservice-with-distributed-messaging.html">Hands-on Lab: Developing a Quarkus microservice with distributed messaging</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../spring-boot-example/spring-boot-example.html">Spring Boot Example</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../spring-boot-example/integrating-jmsamqp-clients-with-spring-boot.html">Integrating JMS/AMQP clients with Spring Boot</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../spring-boot-example/configuring-spring-boot-for-activemq-artemis-connectivity.html">Configuring Spring Boot for ActiveMQ Artemis connectivity</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../spring-boot-example/using-spring-jmsamqp-templates-for-messaging.html">Using Spring JMS/AMQP templates for messaging</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../spring-boot-example/implementing-message-producers-in-spring-boot.html">Implementing message producers in Spring Boot</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../spring-boot-example/implementing-message-consumers-in-spring-boot.html">Implementing message consumers in Spring Boot</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../spring-boot-example/configuring-listener-containers-and-concurrency.html">Configuring listener containers and concurrency</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../spring-boot-example/deploying-spring-boot-messaging-applications-on-openshift.html">Deploying Spring Boot messaging applications on OpenShift</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../spring-boot-example/hands-on-lab-developing-a-spring-boot-microservice-with-distributed-messaging.html">Hands-on Lab: Developing a Spring Boot microservice with distributed messaging</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Building Resilient Messaging Applications with ActiveMQ Artemis and OpenShift</span>
    <span class="version">1.0.0</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">Building Resilient Messaging Applications with ActiveMQ Artemis and OpenShift</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">1.0.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Building Resilient Messaging Applications with ActiveMQ Artemis and OpenShift</a></li>
    <li><a href="quarkus-example.html">Quarkus Example</a></li>
    <li><a href="implementing-message-producers-in-quarkus.html">Implementing message producers in Quarkus</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Implementing message producers in Quarkus</h1>
<h1 id="_implementing_message_producers_in_quarkus" class="sect0"><a class="anchor" href="#_implementing_message_producers_in_quarkus"></a>Implementing Message Producers in Quarkus</h1>
<div class="paragraph">
<p>This section delves into the implementation of message producers within Quarkus applications, focusing on how to send messages to an ActiveMQ Artemis broker. We will explore both traditional Jakarta Messaging (JMS) approaches and the more modern, reactive SmallRye Reactive Messaging API provided by Quarkus.</p>
</div>
<div class="sect1">
<h2 id="_overview_of_message_producers"><a class="anchor" href="#_overview_of_message_producers"></a>Overview of Message Producers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A message producer is an application component responsible for creating and sending messages to a messaging destination (queue or topic) on a message broker. In the context of ActiveMQ Artemis and Quarkus, producers enable your microservices to publish events, commands, or data asynchronously, facilitating decoupled communication between different parts of a distributed system.</p>
</div>
<div class="paragraph">
<p>Quarkus offers robust support for integrating with ActiveMQ Artemis, allowing developers to implement producers efficiently and reliably.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_prerequisites_and_dependencies"><a class="anchor" href="#_prerequisites_and_dependencies"></a>Prerequisites and Dependencies</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To implement message producers in a Quarkus application, you need to include the appropriate dependencies in your <code>pom.xml</code>.</p>
</div>
<div class="paragraph">
<p>For traditional Jakarta Messaging (JMS) producers, use the <code>quarkus-artemis-jms</code> extension:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
    &lt;artifactId&gt;quarkus-artemis-jms&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>For reactive messaging producers using SmallRye Reactive Messaging with JMS connector:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
    &lt;artifactId&gt;quarkus-smallrye-reactive-messaging-jms&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>For reactive messaging producers using SmallRye Reactive Messaging with AMQP connector (if you prefer AMQP over JMS protocol):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
    &lt;artifactId&gt;quarkus-smallrye-reactive-messaging-amqp&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuring_activemq_artemis_connectivity"><a class="anchor" href="#_configuring_activemq_artemis_connectivity"></a>Configuring ActiveMQ Artemis Connectivity</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before implementing a producer, your Quarkus application needs to be configured to connect to the ActiveMQ Artemis broker. This typically involves setting connection parameters in <code>src/main/resources/application.properties</code>.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s a basic configuration for connecting to an ActiveMQ Artemis broker:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties"># ActiveMQ Artemis connection settings
quarkus.artemis.url=tcp://localhost:61616
quarkus.artemis.username=artemis
quarkus.artemis.password=artemis
# Optional: Enable connection pooling
quarkus.artemis.pooled=true</code></pre>
</div>
</div>
<div class="paragraph">
<p>If using SmallRye Reactive Messaging, you would configure channels:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties"># SmallRye Reactive Messaging configuration for JMS
mp.messaging.outgoing.my-outgoing-channel.connector=smallrye-jms
mp.messaging.outgoing.my-outgoing-channel.destination-type=queue
mp.messaging.outgoing.my-outgoing-channel.destination=my-queue

# SmallRye Reactive Messaging configuration for AMQP
# mp.messaging.outgoing.my-amqp-channel.connector=smallrye-amqp
# mp.messaging.outgoing.my-amqp-channel.host=localhost
# mp.messaging.outgoing.my-amqp-channel.port=5672
# mp.messaging.outgoing.my-amqp-channel.username=artemis
# mp.messaging.outgoing.my-amqp-channel.password=artemis
# mp.messaging.outgoing.my-amqp-channel.address=my-amqp-queue</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the <code>quarkus.artemis.url</code> configuration is still relevant for <code>smallrye-jms</code> connector to establish the underlying JMS connection.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementing_a_jakarta_messaging_jms_producer"><a class="anchor" href="#_implementing_a_jakarta_messaging_jms_producer"></a>Implementing a Jakarta Messaging (JMS) Producer</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Quarkus provides seamless integration with Jakarta Messaging. You can inject <code>jakarta.jms.JMSContext</code> and use it to create and send messages.</p>
</div>
<div class="sect2">
<h3 id="_sending_text_messages"><a class="anchor" href="#_sending_text_messages"></a>Sending Text Messages</h3>
<div class="paragraph">
<p>The most common type of message is a text message.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import jakarta.enterprise.context.ApplicationScoped;
import jakarta.inject.Inject;
import jakarta.jms.ConnectionFactory;
import jakarta.jms.JMSContext;
import jakarta.jms.Queue;
import jakarta.annotation.PostConstruct;

@ApplicationScoped
public class JmsMessageProducer {

    @Inject
    ConnectionFactory connectionFactory; // Injected by Quarkus

    private Queue myQueue; // The destination queue

    @PostConstruct
    void init() {
        // You can look up queues/topics or create them programmatically
        try (JMSContext context = connectionFactory.createContext()) {
            myQueue = context.createQueue("my-jms-queue");
        }
    }

    public void sendMessage(String messageContent) {
        try (JMSContext context = connectionFactory.createContext()) {
            context.createProducer()
                   .send(myQueue, messageContent);
            System.out.println("JMS Producer sent message: " + messageContent + " to queue: my-jms-queue");
        } catch (Exception e) {
            System.err.println("Error sending JMS message: " + e.getMessage());
        }
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_sending_object_messages"><a class="anchor" href="#_sending_object_messages"></a>Sending Object Messages</h3>
<div class="paragraph">
<p>JMS also supports sending Java objects, which must implement <code>java.io.Serializable</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import jakarta.enterprise.context.ApplicationScoped;
import jakarta.inject.Inject;
import jakarta.jms.ConnectionFactory;
import jakarta.jms.JMSContext;
import jakarta.jms.ObjectMessage;
import jakarta.jms.Queue;
import jakarta.annotation.PostConstruct;

import java.io.Serializable;

// A simple serializable payload
class MyPayload implements Serializable {
    private String name;
    private int value;

    public MyPayload(String name, int value) {
        this.name = name;
        this.value = value;
    }

    public String getName() { return name; }
    public int getValue() { return value; }

    @Override
    public String toString() {
        return "MyPayload{" +
               "name='" + name + '\'' +
               ", value=" + value +
               '}';
    }
}

@ApplicationScoped
public class JmsObjectProducer {

    @Inject
    ConnectionFactory connectionFactory;

    private Queue myObjectQueue;

    @PostConstruct
    void init() {
        try (JMSContext context = connectionFactory.createContext()) {
            myObjectQueue = context.createQueue("my-object-queue");
        }
    }

    public void sendObjectMessage(MyPayload payload) {
        try (JMSContext context = connectionFactory.createContext()) {
            ObjectMessage message = context.createObjectMessage(payload);
            context.createProducer()
                   .send(myObjectQueue, message);
            System.out.println("JMS Producer sent object message: " + payload + " to queue: my-object-queue");
        } catch (Exception e) {
            System.err.println("Error sending JMS object message: " + e.getMessage());
        }
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_adding_message_properties_and_headers"><a class="anchor" href="#_adding_message_properties_and_headers"></a>Adding Message Properties and Headers</h3>
<div class="paragraph">
<p>You can customize messages by setting properties (key-value pairs) and headers (standard JMS properties).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import jakarta.enterprise.context.ApplicationScoped;
import jakarta.inject.Inject;
import jakarta.jms.ConnectionFactory;
import jakarta.jms.JMSContext;
import jakarta.jms.Queue;
import jakarta.jms.TextMessage;
import jakarta.annotation.PostConstruct;

@ApplicationScoped
public class JmsAdvancedProducer {

    @Inject
    ConnectionFactory connectionFactory;

    private Queue myAdvancedQueue;

    @PostConstruct
    void init() {
        try (JMSContext context = connectionFactory.createContext()) {
            myAdvancedQueue = context.createQueue("my-advanced-queue");
        }
    }

    public void sendAdvancedMessage(String messageContent, String userId) {
        try (JMSContext context = connectionFactory.createContext()) {
            TextMessage message = context.createTextMessage(messageContent);

            // Set a custom property
            message.setStringProperty("UserId", userId);
            message.setLongProperty("Timestamp", System.currentTimeMillis());

            // Set standard JMS headers (e.g., correlation ID for request-reply patterns)
            message.setJMSCorrelationID("correlation-" + System.nanoTime());
            message.setJMSType("OrderEvent");

            context.createProducer()
                   .setDeliveryMode(jakarta.jms.DeliveryMode.PERSISTENT) // Ensure message durability
                   .setPriority(5)
                   .setTimeToLive(300000) // 5 minutes TTL
                   .send(myAdvancedQueue, message);
            System.out.println("JMS Producer sent advanced message: '" + messageContent + "' with UserId: " + userId + " to queue: my-advanced-queue");
        } catch (Exception e) {
            System.err.println("Error sending advanced JMS message: " + e.getMessage());
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementing_a_reactive_messaging_producer_smallrye_reactive_messaging"><a class="anchor" href="#_implementing_a_reactive_messaging_producer_smallrye_reactive_messaging"></a>Implementing a Reactive Messaging Producer (SmallRye Reactive Messaging)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Quarkus&#8217;s SmallRye Reactive Messaging provides a powerful and idiomatic way to handle message production reactively. It abstracts away the underlying messaging protocol (JMS, AMQP, Kafka, etc.) and allows you to use familiar Java constructs.</p>
</div>
<div class="sect2">
<h3 id="_using_outgoing_and_emitter"><a class="anchor" href="#_using_outgoing_and_emitter"></a>Using <code>@Outgoing</code> and <code>Emitter</code></h3>
<div class="paragraph">
<p>The <code>@Outgoing</code> annotation marks a method or field as a source of messages for a specific channel. You can inject an <code>Emitter&lt;T&gt;</code> to send messages.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import jakarta.enterprise.context.ApplicationScoped;
import jakarta.inject.Inject;
import org.eclipse.microprofile.reactive.messaging.Channel;
import org.eclipse.microprofile.reactive.messaging.Emitter;
import io.smallrye.mutiny.Uni;

@ApplicationScoped
public class ReactiveMessageProducer {

    // Inject an Emitter for the 'my-outgoing-channel' defined in application.properties
    @Inject
    @Channel("my-outgoing-channel")
    Emitter&lt;String&gt; textEmitter;

    // You can also emit objects if the connector supports serialization
    @Inject
    @Channel("my-outgoing-object-channel") // Make sure this channel is also configured
    Emitter&lt;MyPayload&gt; objectEmitter;

    public void sendReactiveTextMessage(String messageContent) {
        // Send the message asynchronously
        Uni&lt;Void&gt; ack = textEmitter.send(messageContent);
        ack.subscribe().with(
            v -&gt; System.out.println("Reactive Producer sent text message: " + messageContent),
            err -&gt; System.err.println("Failed to send reactive text message: " + err.getMessage())
        );
    }

    public void sendReactiveObjectMessage(MyPayload payload) {
        // Send the object message asynchronously
        Uni&lt;Void&gt; ack = objectEmitter.send(payload);
        ack.subscribe().with(
            v -&gt; System.out.println("Reactive Producer sent object message: " + payload),
            err -&gt; System.err.println("Failed to send reactive object message: " + err.getMessage())
        );
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For the <code>ReactiveMessageProducer</code> to work, ensure your <code>application.properties</code> defines the channels:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties"># For textEmitter
mp.messaging.outgoing.my-outgoing-channel.connector=smallrye-jms
mp.messaging.outgoing.my-outgoing-channel.destination-type=queue
mp.messaging.outgoing.my-outgoing-channel.destination=my-reactive-text-queue

# For objectEmitter
mp.messaging.outgoing.my-outgoing-object-channel.connector=smallrye-jms
mp.messaging.outgoing.my-outgoing-object-channel.destination-type=queue
mp.messaging.outgoing.my-outgoing-object-channel.destination=my-reactive-object-queue</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_using_outgoing_with_methods_stream_based_production"><a class="anchor" href="#_using_outgoing_with_methods_stream_based_production"></a>Using <code>@Outgoing</code> with methods (Stream-based production)</h3>
<div class="paragraph">
<p>Instead of <code>Emitter</code>, you can also use methods annotated with <code>@Outgoing</code> to produce messages continuously or upon specific events. This is particularly useful for generating data streams.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import jakarta.enterprise.context.ApplicationScoped;
import io.smallrye.mutiny.Multi;
import org.eclipse.microprofile.reactive.messaging.Outgoing;

import java.time.Duration;
import java.util.Random;

@ApplicationScoped
public class StreamProducer {

    private Random random = new Random();

    // This method will send a random integer every second to 'my-data-stream' channel
    @Outgoing("my-data-stream")
    public Multi&lt;Integer&gt; generate() {
        return Multi.createFrom().ticks().every(Duration.ofSeconds(1))
                .onItem().transform(tick -&gt; {
                    int value = random.nextInt(100);
                    System.out.println("Generating data stream item: " + value);
                    return value;
                });
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>And the <code>application.properties</code> for this stream:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">mp.messaging.outgoing.my-data-stream.connector=smallrye-jms
mp.messaging.outgoing.my-data-stream.destination-type=queue
mp.messaging.outgoing.my-data-stream.destination=my-data-stream-queue</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_hands_on_lab_deploying_a_quarkus_producer_and_verifying_message_flow"><a class="anchor" href="#_hands_on_lab_deploying_a_quarkus_producer_and_verifying_message_flow"></a>Hands-on Lab: Deploying a Quarkus Producer and Verifying Message Flow</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this lab, you will set up a basic Quarkus application that acts as a message producer, sending messages to an ActiveMQ Artemis queue. You&#8217;ll then use the Artemis console to verify that messages are being sent correctly.</p>
</div>
<div class="sect2">
<h3 id="_objectives"><a class="anchor" href="#_objectives"></a>Objectives</h3>
<div class="ulist">
<ul>
<li>
<p>Create a Quarkus project with ActiveMQ Artemis JMS dependencies.</p>
</li>
<li>
<p>Implement a simple Jakarta Messaging producer.</p>
</li>
<li>
<p>Configure the Quarkus application to connect to an ActiveMQ Artemis broker.</p>
</li>
<li>
<p>Run the Quarkus application and verify messages in the Artemis console.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_prerequisites"><a class="anchor" href="#_prerequisites"></a>Prerequisites</h3>
<div class="ulist">
<ul>
<li>
<p>Java 17+</p>
</li>
<li>
<p>Maven 3.8+</p>
</li>
<li>
<p>Quarkus CLI (optional, but recommended) or Maven installed.</p>
</li>
<li>
<p>A running ActiveMQ Artemis broker (e.g., using Docker or a local installation).</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_start_an_activemq_artemis_broker_if_not_already_running"><a class="anchor" href="#_start_an_activemq_artemis_broker_if_not_already_running"></a>Start an ActiveMQ Artemis Broker (if not already running)</h4>
<div class="paragraph">
<p>You can quickly start an Artemis broker using Docker:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">docker run -it --rm \
    -p 8161:8161 \
    -p 61616:61616 \
    -e ARTEMIS_USERNAME=artemis \
    -e ARTEMIS_PASSWORD=artemis \
    -e ARTEMIS_MIN_MEMORY=512M \
    -e ARTEMIS_MAX_MEMORY=1G \
    apache/activemq-artemis:latest</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command exposes the management console on <code><a href="http://localhost:8161" class="bare">http://localhost:8161</a></code> (login: <code>artemis/artemis</code>) and the JMS/AMQP port on <code>61616</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_1_create_a_new_quarkus_project"><a class="anchor" href="#_step_1_create_a_new_quarkus_project"></a>Step 1: Create a New Quarkus Project</h3>
<div class="paragraph">
<p>Use the Quarkus CLI or Maven to create a new project.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">quarkus create app quarkus-artemis-producer \
    --extension=quarkus-artemis-jms \
    --extension=quarkus-resteasy-reactive \
    --extension=quarkus-smallrye-reactive-messaging-jms</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you don&#8217;t have Quarkus CLI:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">mvn io.quarkus.platform:quarkus-maven-plugin:$(quarkus --version | grep -o '^[0-9]\+\.[0-9]\+\.[0-9]\+' | head -1):create \
    -DprojectGroupId=org.example \
    -DprojectArtifactId=quarkus-artemis-producer \
    -Dextensions="artemis-jms,resteasy-reactive,smallrye-reactive-messaging-jms" \
    -DnoCode</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_2_configure_application_properties"><a class="anchor" href="#_step_2_configure_application_properties"></a>Step 2: Configure <code>application.properties</code></h3>
<div class="paragraph">
<p>Open <code>src/main/resources/application.properties</code> and add the ActiveMQ Artemis connection details and a reactive messaging channel:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties"># ActiveMQ Artemis connection
quarkus.artemis.url=tcp://localhost:61616
quarkus.artemis.username=artemis
quarkus.artemis.password=artemis
quarkus.artemis.pooled=true

# Reactive Messaging Channel Configuration
mp.messaging.outgoing.my-reactive-channel.connector=smallrye-jms
mp.messaging.outgoing.my-reactive-channel.destination-type=queue
mp.messaging.outgoing.my-reactive-channel.destination=my-quarkus-queue

# Expose producer via a REST endpoint
quarkus.http.port=8080</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_3_implement_the_jms_and_reactive_producers"><a class="anchor" href="#_step_3_implement_the_jms_and_reactive_producers"></a>Step 3: Implement the JMS and Reactive Producers</h3>
<div class="paragraph">
<p>Create a new Java class <code>src/main/java/org/example/QuarkusProducerResource.java</code> and add the following code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.example;

import jakarta.enterprise.context.ApplicationScoped;
import jakarta.inject.Inject;
import jakarta.jms.ConnectionFactory;
import jakarta.jms.JMSContext;
import jakarta.jms.Queue;
import jakarta.annotation.PostConstruct;
import jakarta.ws.rs.GET;
import jakarta.ws.rs.Path;
import jakarta.ws.rs.Produces;
import jakarta.ws.rs.QueryParam;
import jakarta.ws.rs.core.MediaType;

import org.eclipse.microprofile.reactive.messaging.Channel;
import org.eclipse.microprofile.reactive.messaging.Emitter;
import io.smallrye.mutiny.Uni;

@Path("/messages")
@ApplicationScoped
public class QuarkusProducerResource {

    // --- JMS Producer ---
    @Inject
    ConnectionFactory connectionFactory;

    private Queue jmsQueue;

    @PostConstruct
    void initJms() {
        try (JMSContext context = connectionFactory.createContext()) {
            jmsQueue = context.createQueue("my-quarkus-queue");
        }
    }

    @GET
    @Path("/send-jms")
    @Produces(MediaType.TEXT_PLAIN)
    public String sendJmsMessage(@QueryParam("text") String messageContent) {
        if (messageContent == null || messageContent.isEmpty()) {
            messageContent = "Hello from Quarkus JMS! " + System.currentTimeMillis();
        }
        try (JMSContext context = connectionFactory.createContext()) {
            context.createProducer()
                   .send(jmsQueue, messageContent);
            return "JMS Message sent: " + messageContent;
        } catch (Exception e) {
            e.printStackTrace();
            return "Failed to send JMS message: " + e.getMessage();
        }
    }

    // --- Reactive Messaging Producer ---
    @Inject
    @Channel("my-reactive-channel")
    Emitter&lt;String&gt; reactiveEmitter;

    @GET
    @Path("/send-reactive")
    @Produces(MediaType.TEXT_PLAIN)
    public Uni&lt;String&gt; sendReactiveMessage(@QueryParam("text") String messageContent) {
        if (messageContent == null || messageContent.isEmpty()) {
            messageContent = "Hello from Quarkus Reactive Messaging! " + System.currentTimeMillis();
        }
        String finalMessageContent = messageContent;
        return Uni.createFrom().completionStage(reactiveEmitter.send(finalMessageContent).toCompletionStage())
                   .onItem().transform(v -&gt; "Reactive Message sent: " + finalMessageContent)
                   .onFailure().transform(err -&gt; {
                       System.err.println("Failed to send reactive message: " + err.getMessage());
                       return new RuntimeException("Failed to send reactive message", err);
                   });
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_4_run_the_quarkus_application"><a class="anchor" href="#_step_4_run_the_quarkus_application"></a>Step 4: Run the Quarkus Application</h3>
<div class="paragraph">
<p>Navigate to the project root directory in your terminal and run the Quarkus application in development mode:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./mvnw quarkus:dev</code></pre>
</div>
</div>
<div class="paragraph">
<p>The application will start, and you should see logs indicating it&#8217;s ready.</p>
</div>
</div>
<div class="sect2">
<h3 id="_step_5_send_messages_via_rest_endpoints"><a class="anchor" href="#_step_5_send_messages_via_rest_endpoints"></a>Step 5: Send Messages via REST Endpoints</h3>
<div class="paragraph">
<p>Open your web browser or use <code>curl</code> to send messages:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Send a JMS message:</strong>
[source,bash]
----
curl <a href="http://localhost:8080/messages/send-jms?text="My" class="bare">http://localhost:8080/messages/send-jms?text="My</a> first JMS message"
----</p>
</li>
<li>
<p><strong>Send a Reactive message:</strong>
[source,bash]
----
curl <a href="http://localhost:8080/messages/send-reactive?text="My" class="bare">http://localhost:8080/messages/send-reactive?text="My</a> first Reactive message"
----</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You should see confirmation messages in your browser/terminal and in the Quarkus application console.</p>
</div>
</div>
<div class="sect2">
<h3 id="_step_6_verify_messages_in_activemq_artemis_console"><a class="anchor" href="#_step_6_verify_messages_in_activemq_artemis_console"></a>Step 6: Verify Messages in ActiveMQ Artemis Console</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open your web browser and navigate to the ActiveMQ Artemis console at <code><a href="http://localhost:8161" class="bare">http://localhost:8161</a></code>.</p>
</li>
<li>
<p>Log in with username <code>artemis</code> and password <code>artemis</code>.</p>
</li>
<li>
<p>In the left navigation, click on <strong>Queues</strong>.</p>
</li>
<li>
<p>You should see a queue named <code>my-quarkus-queue</code>.</p>
</li>
<li>
<p>Click on <code>my-quarkus-queue</code> to view its details.</p>
</li>
<li>
<p>You should see the "Messages Added" count increase with each message you send from your Quarkus application.</p>
</li>
<li>
<p>To inspect the messages, select the <code>my-quarkus-queue</code> and click on the "Browse Messages" button. You will be able to view the content of the messages sent by your Quarkus producers.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>This lab demonstrates how to successfully implement and verify message production from a Quarkus application to an ActiveMQ Artemis broker using both traditional JMS and modern Reactive Messaging APIs.</p>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="configuring-quarkus-for-activemq-artemis-connectivity.html">Configuring Quarkus for ActiveMQ Artemis connectivity</a></span>
  <span class="next"><a href="implementing-message-consumers-in-quarkus.html">Implementing message consumers in Quarkus</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <img src="../../../_/img/rhl-logo-red.png" height="40px" alt="Red Hat"  href="https://redhat.com" >
</footer><script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
