#  Configuring services and routes for load balancing

== Configuring Services and Routes for Load Balancing

In a multi-node ActiveMQ Artemis deployment, ensuring even distribution of messages across brokers is crucial for optimal performance. One effective method to achieve this is by configuring services and routes for load balancing. This section will guide you through the process of setting up load balancing for your ActiveMQ Artemis cluster on OpenShift.

### OpenShift Services

OpenShift Services provide a way to expose your ActiveMQ Artemis brokers as a stable endpoint, enabling load balancing and service discovery. To create a Service, follow these steps:

1. **Create a Service YAML file**: Define the Service configuration in a YAML file. For example:

   ```yaml
   apiVersion: v1
   kind: Service
   metadata:
     name: artemis-service
   spec:
     selector:
       app: artemis
     ports:
       - protocol: TCP
         targetPort: 61616
         port: 5672
     type: ClusterIP
   ```

   In this example, the Service exposes port 5672 (the default JMS port) and targets port 61616 on the ActiveMQ Artemis pods. The `type: ClusterIP` ensures that the Service is only accessible within the OpenShift cluster.

2. **Apply the Service configuration**: Use `oc apply -f <service-file>.yaml` to create the Service.

### OpenShift Routes

To expose your ActiveMQ Artemis cluster to external clients, you can create an OpenShift Route. This allows for load balancing and SSL termination if required. Here's how to create a Route:

1. **Create a Route YAML file**: Define the Route configuration in a YAML file. For example:

   ```yaml
   apiVersion: route.openshift.io/v1
   kind: Route
   metadata:
     name: artemis-route
   spec:
     host: artemis.example.com
     to:
       kind: Service
       name: artemis-service
     port:
       targetPort: 5672
       path: ''
   ```

   In this example, the Route exposes the `artemis-service` on `artemis.example.com` with port 5672.

2. **Apply the Route configuration**: Use `oc apply -f <route-file>.yaml` to create the Route.

### Load Balancing

